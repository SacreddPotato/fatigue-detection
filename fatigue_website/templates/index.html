<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fatigue Detection Model</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 2rem auto; padding: 0 1rem; background-color: #f4f4f9; }
        .container { background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-align: center; }
        h1 { color: #333; }
        .upload-area { margin: 2rem 0; padding: 2rem; border: 2px dashed #ccc; border-radius: 8px; }
        input[type="file"] { margin-bottom: 1rem; }
        button { background-color: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-size: 1rem; }
        button:hover { background-color: #0056b3; }
        .result-box { margin-top: 2rem; padding: 1rem; border-radius: 8px; }
        .fatigue { background-color: #ffebee; color: #c62828; border: 1px solid #ffcdd2; }
        .active { background-color: #e8f5e9; color: #2e7d32; border: 1px solid #c8e6c9; }
        .error { color: red; margin-top: 1rem; }
        
        /* New style for the displayed image */
        .analyzed-image {
            max-width: 300px;
            width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Fatigue Detection System</h1>
        <p>Upload a worker's image to detect fatigue levels.</p>

        <div class="upload-area">
            <form method="post" enctype="multipart/form-data">
                <input type="file" name="file" accept="image/*" required>
                <br>
                <button type="submit">Analyze Image</button>
            </form>
        </div>

        {% if error %}
            <div class="error">{{ error }}</div>
        {% endif %}

        {% if result %}
            <div class="result-box {% if 'Fatigue' in result.label %}fatigue{% else %}active{% endif %}">
                {% if image_data %}
                    <img src="{{ image_data }}" alt="Analyzed Image" class="analyzed-image">
                {% endif %}
                
                <h2>{{ result.label }}</h2>
                <p>Confidence: <strong>{{ result.probability }}</strong></p>
                <small>Raw Model Output: {{ result.raw_score }}</small>
            </div>
        {% endif %}
    </div>
</body>
</html>